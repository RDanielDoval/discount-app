query Input {
  cart {
    lines {
      quantity
      cost {
        totalAmount {
          amount
        }
      }
      merchandise {
        __typename
        ...on ProductVariant {
          id
        }
      }
    }
  }
  discountNode {
    metafield(namespace: "some-space", key: "function-config") {
      value
    }
  }
}
# query Input {
#   cart {
#     lines {
#       id
#       merchandise {
#         id
#       }
#     }
#   }
# }
# query Input {
#   cart {
#     lines {
#       attribute(key: "ReKeepIt") {
#         values
#       },
#       id,
#       cost {
#         totalAmount {
#           amount
#         }
#       }
#       merchandise {
#         __typename
#         ...on ProductVariant {
#           id,
#           product {
#             hasAnyTag(tags: ["RKI", "RKI:123"])
#           }
#         }
#       }
#     }
#   }
#   discountNode {
#     metafield(namespace: "fixed-amount", key: "function-configuration") {
#       value
#     }
#   }
# }



# RKI_TAG_KEY = "RKI"
# RKI_TAG_DELIMITER = ":"
# RKI_DISCOUNT_MESSAGE = "ReKeepIt"
# RKI_LI_PROP_KEY = "ReKeepIt"
# for line_item in Input.cart.line_items
#   rki_discount = false
#   if line_item.properties[RKI_LI_PROP_KEY]
#     for tag in line_item.variant.product.tags
#       if tag.include? RKI_TAG_KEY
#         puts "FOUND TAG: "
#         puts tag
#         rki_tag_arr = tag.split(RKI_TAG_DELIMITER)
#         puts rki_tag_arr.length
#         if tag.include? line_item.variant.id.to_s or rki_tag_arr.length == 2
#       	  puts "TRUE"
#       	  rki_discount = line_item.line_price * (rki_tag_arr[-1].to_f / 100)
#       	  puts rki_discount
#       	  break
#         end
#       end
#     end
#     line_item.change_line_price(line_item.line_price - rki_discount, { message: RKI_DISCOUNT_MESSAGE }) if rki_discount
#   end
# end
